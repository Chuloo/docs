"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[5569],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return m}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),p=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=p(e.components);return a.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),d=p(n),m=r,h=d["".concat(l,".").concat(m)]||d[m]||u[m]||o;return n?a.createElement(h,i(i({ref:t},c),{},{components:n})):a.createElement(h,i({ref:t},c))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,i[1]=s;for(var p=2;p<o;p++)i[p]=n[p];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},3796:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return s},contentTitle:function(){return l},metadata:function(){return p},toc:function(){return c},default:function(){return d}});var a=n(7462),r=n(3366),o=(n(7294),n(3905)),i=["components"],s={title:"Script extensions for enhanced measurement"},l=void 0,p={unversionedId:"script-extensions",id:"script-extensions",title:"Script extensions for enhanced measurement",description:"We're proud to have one of the most lightweight Javascript snippets in the analytics industry. Clocking in at less than 1KB, our script will not add any bloat to your website or cause performance issues.",source:"@site/docs/script-extensions.md",sourceDirName:".",slug:"/script-extensions",permalink:"/docs/script-extensions",editUrl:"https://github.com/plausible/docs/edit/master/docs/script-extensions.md",tags:[],version:"current",frontMatter:{title:"Script extensions for enhanced measurement"},sidebar:"someSidebar",previous:{title:"Add the script to your website",permalink:"/docs/plausible-script"},next:{title:"Integration guides",permalink:"/docs/integration-guides"}},c=[{value:"All our script extensions",id:"all-our-script-extensions",children:[],level:2},{value:"script.compat.js",id:"scriptcompatjs",children:[],level:2},{value:"script.manual.js",id:"scriptmanualjs",children:[{value:"Specify custom locations for your page URLs",id:"specify-custom-locations-for-your-page-urls",children:[],level:3},{value:"Track custom query parameters for complete page URLs",id:"track-custom-query-parameters-for-complete-page-urls",children:[],level:3}],level:2}],u={toc:c};function d(e){var t=e.components,n=(0,r.Z)(e,i);return(0,o.kt)("wrapper",(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"We're proud to have one of the most ",(0,o.kt)("a",{parentName:"p",href:"https://plausible.io/lightweight-web-analytics"},"lightweight Javascript snippets")," in the analytics industry. Clocking in at less than 1KB, our script will not add any bloat to your website or cause performance issues. "),(0,o.kt)("p",null,"One of the ways we achieve that is by radically limiting the amount of options in the default script. Instead, we provide separate script files based on how you might want to use Plausible."),(0,o.kt)("p",null,"For example, the default ",(0,o.kt)("inlineCode",{parentName:"p"},"script.js")," script will automatically work with ",(0,o.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/API/History_API"},"pushState")," based frontend routing which is the most common."),(0,o.kt)("p",null,"If your website uses ",(0,o.kt)("a",{parentName:"p",href:"https://krasimirtsonev.com/blog/article/deep-dive-into-client-side-routing-navigo-pushstate-hash#hash-based-routing"},"hash-based routing")," instead, you have the option of loading the script with a different extension: ",(0,o.kt)("inlineCode",{parentName:"p"},"script.hash.js"),". If you want to automatically track\noutbound links on your website, you can load ",(0,o.kt)("inlineCode",{parentName:"p"},"script.outbound-links.js"),". And if you want both, these extensions can be combined as follows:\n",(0,o.kt)("inlineCode",{parentName:"p"},"script.hash.outbound-links.js"),"."),(0,o.kt)("p",null,"In the case above, the snippet you need to insert into your site is as follows:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},'<script defer data-domain="yourdomain.com" src="https://plausible.io/js/script.hash.outbound-links.js"><\/script>\n')),(0,o.kt)("p",null,"And say you want to use our ",(0,o.kt)("inlineCode",{parentName:"p"},"script.exclusions.js")," extension to exclude certain pages from being tracked and our ",(0,o.kt)("inlineCode",{parentName:"p"},"script.local.js")," extension to track localhost traffic, your snippet should look like this:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},'<script defer data-domain="yourdomain.com" src="https://plausible.io/js/script.exclusions.local.js"><\/script>\n')),(0,o.kt)("p",null,"You can mix and match, and combine extensions any way that you wish. And you only need to insert that one snippet into your site, no need for anything else."),(0,o.kt)("p",null,"This approach makes sure that you only load code that will actually be used on your website. Websites should not have to load dozens or hundreds of kilobytes\nof dead Javascript code on every pageload which degrades the user experience and causes unnecessary network traffic."),(0,o.kt)("h2",{id:"all-our-script-extensions"},"All our script extensions"),(0,o.kt)("p",null,"Here's the list of all the available extensions at this time:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Extension"),(0,o.kt)("th",{parentName:"tr",align:null},"Explanation"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"script.hash.js"),(0,o.kt)("td",{parentName:"tr",align:null},"Automatically follow frontend navigation when using ",(0,o.kt)("a",{parentName:"td",href:"/docs/hash-based-routing"},"hash-based routing"))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"script.outbound-links.js"),(0,o.kt)("td",{parentName:"tr",align:null},"Automatically ",(0,o.kt)("a",{parentName:"td",href:"/docs/outbound-link-click-tracking"},"track clicks on outbound links")," from your website")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"script.exclusions.js"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"/docs/excluding-pages"},"Exclude certain pages from being tracked"))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"script.compat.js"),(0,o.kt)("td",{parentName:"tr",align:null},"Compatibility mode for ",(0,o.kt)("a",{parentName:"td",href:"#plausiblecompatjs"},"tracking users on Internet Explorer"))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"script.local.js"),(0,o.kt)("td",{parentName:"tr",align:null},"Allow analytics to track on localhost too which is useful in hybrid apps")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"script.manual.js"),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"td",href:"#plausiblemanualjs"},"Do not trigger pageviews automatically"),". Also allows you to ",(0,o.kt)("a",{parentName:"td",href:"/docs/custom-locations"},"specify custom locations")," to redact URLs with identifiers. You can also use it to track ",(0,o.kt)("a",{parentName:"td",href:"/docs/custom-query-params"},"custom query parameters"))))),(0,o.kt)("h2",{id:"scriptcompatjs"},"script.compat.js"),(0,o.kt)("p",null,"The default Plausible script will not work on Internet Explorer because it uses the ",(0,o.kt)("a",{parentName:"p",href:"https://caniuse.com/document-currentscript"},"document.currentScript")," API to read configuration options. You can run Plausible in compatibility mode by including the ",(0,o.kt)("inlineCode",{parentName:"p"},"script.compat.js")," extension and defining ",(0,o.kt)("inlineCode",{parentName:"p"},'id="plausible"')," on the script tag so that it can find itself. Here's how it should look like:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},'<script id="plausible" defer data-domain="yourdomain.com" src="https://plausible.io/js/script.compat.js"><\/script>\n')),(0,o.kt)("h2",{id:"scriptmanualjs"},"script.manual.js"),(0,o.kt)("p",null,"By default, the Plausible script triggers a pageview when it is first loaded. It also attaches listeners to the History API and will automatically trigger pageviews when you use ",(0,o.kt)("inlineCode",{parentName:"p"},"history.pushState"),". This is useful for most websites but we also offer a manual mode in case you want full control over when pageviews are triggered on your website."),(0,o.kt)("p",null,"The most common use-case for this is when you use ",(0,o.kt)("a",{parentName:"p",href:"https://turbo.hotwired.dev/"},"Turbo")," (formerly ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/turbolinks/turbolinks"},"Turbolinks"),"). In that case, you want to manually trigger Plausible pageviews on the ",(0,o.kt)("inlineCode",{parentName:"p"},"turbo:load")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"turbolinks:load")," browser event depending which library you use. Here's how you can do that:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},'<script defer data-domain="yourdomain.com" src="https://plausible.io/js/script.manual.js"><\/script>\n\x3c!-- define the `plausible` function to manually trigger events --\x3e\n<script>window.plausible = window.plausible || function() { (window.plausible.q = window.plausible.q || []).push(arguments) }<\/script>\n\x3c!-- trigger pageviews on turbolinks navigation --\x3e\n<script>\ndocument.addEventListener("turbo:load", function() {\n  plausible(\'pageview\')\n})\n<\/script>\n')),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"When using turbolinks, make sure that the Plausible script isn't loaded and executed during turbo navigation. You may need to move the script to the ",(0,o.kt)("inlineCode",{parentName:"p"},"<head>")," section of your website or use the ",(0,o.kt)("inlineCode",{parentName:"p"},'data-turbo-eval="false"')," attribute."))),(0,o.kt)("h3",{id:"specify-custom-locations-for-your-page-urls"},"Specify custom locations for your page URLs"),(0,o.kt)("p",null,"Additionally, the manual script extension allows you to provide a special option named ",(0,o.kt)("inlineCode",{parentName:"p"},"u")," with your events. This allows you to specify the URL of the page and can be used to specify custom locations. "),(0,o.kt)("p",null,"It is especially helpful to redact and aggregate multiple pages whose URLs contain identifiers that are specific to users. ",(0,o.kt)("a",{parentName:"p",href:"/docs/custom-locations"},"Learn more about specifying custom URLs in your events"),"."),(0,o.kt)("h3",{id:"track-custom-query-parameters-for-complete-page-urls"},"Track custom query parameters for complete page URLs"),(0,o.kt)("p",null,"By default, Plausible strips all query parameters for privacy purposes ",(0,o.kt)("a",{parentName:"p",href:"/docs/manual-link-tagging"},"except")," ",(0,o.kt)("inlineCode",{parentName:"p"},"ref"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"source"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"utm_source"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"utm_medium"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"utm_campaign"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"utm_content")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"utm_term"),". "),(0,o.kt)("p",null,"This means that pages like ",(0,o.kt)("inlineCode",{parentName:"p"},"yoursite.com/blog/index.php?article=some_article&page=11")," will be reported as ",(0,o.kt)("inlineCode",{parentName:"p"},"yoursite.com/blog/index.php")," in the Top Pages report of your Plausible dashboard."),(0,o.kt)("p",null,"By using the manual script extension, you can also track custom query parameters and get the complete page URLs in your Top Pages report. Learn here ",(0,o.kt)("a",{parentName:"p",href:"/docs/custom-query-params"},"how to do that"),"."))}d.isMDXComponent=!0}}]);