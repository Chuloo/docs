"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[7180],{3905:function(e,t,a){a.d(t,{Zo:function(){return s},kt:function(){return d}});var r=a(7294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var u=r.createContext({}),p=function(e){var t=r.useContext(u),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},s=function(e){var t=p(e.components);return r.createElement(u.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,o=e.originalType,u=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),m=p(a),d=n,h=m["".concat(u,".").concat(d)]||m[d]||c[d]||o;return a?r.createElement(h,i(i({ref:t},s),{},{components:a})):r.createElement(h,i({ref:t},s))}));function d(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=a.length,i=new Array(o);i[0]=m;var l={};for(var u in t)hasOwnProperty.call(t,u)&&(l[u]=t[u]);l.originalType=e,l.mdxType="string"==typeof e?e:n,i[1]=l;for(var p=2;p<o;p++)i[p]=a[p];return r.createElement.apply(null,i)}return r.createElement.apply(null,a)}m.displayName="MDXCreateElement"},7098:function(e,t,a){a.r(t),a.d(t,{frontMatter:function(){return l},contentTitle:function(){return u},metadata:function(){return p},toc:function(){return s},default:function(){return m}});var r=a(7462),n=a(3366),o=(a(7294),a(3905)),i=["components"],l={title:"Tracking custom query parameters"},u=void 0,p={unversionedId:"custom-query-params",id:"custom-query-params",title:"Tracking custom query parameters",description:"By default, Plausible strips all query parameters for privacy purposes except ref, source, utmsource, utmmedium, utmcampaign, utmcontent and utm_term.",source:"@site/docs/custom-query-params.md",sourceDirName:".",slug:"/custom-query-params",permalink:"/docs/custom-query-params",editUrl:"https://github.com/plausible/docs/edit/master/docs/custom-query-params.md",tags:[],version:"current",frontMatter:{title:"Tracking custom query parameters"}},s=[{value:"1. Add the <code>manual</code> script extension",id:"1-add-the-manual-script-extension",children:[],level:2},{value:"2. Trigger the pageview event with a custom <code>u</code> attribute",id:"2-trigger-the-pageview-event-with-a-custom-u-attribute",children:[],level:2}],c={toc:s};function m(e){var t=e.components,a=(0,n.Z)(e,i);return(0,o.kt)("wrapper",(0,r.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"By default, Plausible strips all query parameters for privacy purposes ",(0,o.kt)("a",{parentName:"p",href:"/docs/manual-link-tagging"},"except")," ",(0,o.kt)("inlineCode",{parentName:"p"},"ref"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"source"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"utm_source"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"utm_medium"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"utm_campaign"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"utm_content")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"utm_term"),". "),(0,o.kt)("p",null,"This means that pages like ",(0,o.kt)("inlineCode",{parentName:"p"},"yoursite.com/blog/index.php?article=some_article&page=11")," will be reported as ",(0,o.kt)("inlineCode",{parentName:"p"},"yoursite.com/blog/index.php")," in the Top Pages report of your Plausible dashboard."),(0,o.kt)("p",null,"If you still want some pages to be reported with the complete URL that includes the query part, here's what you should do:"),(0,o.kt)("h2",{id:"1-add-the-manual-script-extension"},"1. Add the ",(0,o.kt)("inlineCode",{parentName:"h2"},"manual")," script extension"),(0,o.kt)("p",null,"You can use ",(0,o.kt)("a",{parentName:"p",href:"/docs/script-extensions#plausiblemanualjs"},"Plausible's manual script extension")," and define a custom location for all such pageviews. "),(0,o.kt)("p",null,"To do so, change your Plausible script snippet ",(0,o.kt)("inlineCode",{parentName:"p"},"src")," attribute from ",(0,o.kt)("inlineCode",{parentName:"p"},"https://plausible.io/js/script.js")," to ",(0,o.kt)("inlineCode",{parentName:"p"},"https://plausible.io/js/script.manual.js"),"."),(0,o.kt)("p",null,"The new snippet will look like this (make sure to change the ",(0,o.kt)("inlineCode",{parentName:"p"},"data-domain")," attribute to the domain you added to your Plausible account):"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},'<script defer data-domain="yourdomain.com" src="https://plausible.io/js/script.manual.js"><\/script>\n')),(0,o.kt)("p",null,"Do this on all the pages where you want to track the custom query parameters."),(0,o.kt)("h2",{id:"2-trigger-the-pageview-event-with-a-custom-u-attribute"},"2. Trigger the pageview event with a custom ",(0,o.kt)("inlineCode",{parentName:"h2"},"u")," attribute"),(0,o.kt)("p",null,"Once you've started using the manual extension, the ",(0,o.kt)("inlineCode",{parentName:"p"},"pageview")," event won't be sent automatically. This means that the stats won't be tracked anymore by default. You'll have to trigger the events to be counted manually."),(0,o.kt)("p",null,"To trigger events manually, you need to add the following script after your regular Plausible tracking snippet:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},"\x3c!-- define the `plausible` function to manually trigger events --\x3e\n<script>window.plausible = window.plausible || function() { (window.plausible.q = window.plausible.q || []).push(arguments) }<\/script>\n")),(0,o.kt)("p",null,"Once that's done, you can create another script in which you will trigger your pageview event. This is where you can also define a custom location and\nmake the query part of the URL look like a standard subfolder. To do so, add the following snippet:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},'\x3c!-- trigger pageview --\x3e\n<script>\n  function prepareUrl(params) {\n    const url = new URL(location.href)\n    const queryParams = new URLSearchParams(location.search)\n    let customUrl = url.protocol + "//" + url.hostname + url.pathname\n    for (const paramName of params) {\n      const paramValue = queryParams.get(paramName)\n      if (paramValue) customUrl = customUrl + \'/\' + paramValue\n    }\n    return customUrl\n  }\n  plausible(\'pageview\', { u: prepareUrl(["CUSTOM_PARAM_1", "CUSTOM_PARAM_2", ... ]) })\n<\/script>\n')),(0,o.kt)("p",null,"Make sure to replace ",(0,o.kt)("inlineCode",{parentName:"p"},"CUSTOM_PARAM_X")," with your query parameter names. You can define as many as you want.\nFor example, for ",(0,o.kt)("inlineCode",{parentName:"p"},"yoursite.com/blog/index.php?article=some_article&page=11")," you could write the last line as"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},'plausible(\'pageview\', { u: prepareUrl(["article", "page"]) });\n')),(0,o.kt)("p",null,"and the page path will be reported to your dashboard as ",(0,o.kt)("inlineCode",{parentName:"p"},"blog/index.php/some_article/11")),(0,o.kt)("p",null,"At this point, your entire setup should look like this:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},'<script defer data-domain="yourdomain.com" src="https://plausible.io/js/script.manual.js"><\/script>\n\x3c!-- define the `plausible` function to manually trigger events --\x3e\n<script>window.plausible = window.plausible || function() { (window.plausible.q = window.plausible.q || []).push(arguments) }<\/script>\n\x3c!-- trigger pageview --\x3e\n<script>\n  function prepareUrl(params) {\n    const url = new URL(location.href)\n    const queryParams = new URLSearchParams(location.search)\n    let customUrl = url.protocol + "//" + url.hostname + url.pathname\n    for (const paramName of params) {\n      const paramValue = queryParams.get(paramName)\n      if (paramValue) customUrl = customUrl + \'/\' + paramValue\n    }\n    return customUrl\n  }\n  plausible(\'pageview\', { u: prepareUrl(["CUSTOM_PARAM_1", "CUSTOM_PARAM_2", ... ]) })\n<\/script>\n')),(0,o.kt)("p",null,"That's it! You're now tracking the complete URLs of the pages that include custom parameters."))}m.isMDXComponent=!0}}]);