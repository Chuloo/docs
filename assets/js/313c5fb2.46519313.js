"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[5863],{3905:function(e,t,a){a.d(t,{Zo:function(){return p},kt:function(){return m}});var n=a(7294);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var s=n.createContext({}),u=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):r(r({},t),e)),a},p=function(e){var t=u(e.components);return n.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var a=e.components,i=e.mdxType,o=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),d=u(a),m=i,h=d["".concat(s,".").concat(m)]||d[m]||c[m]||o;return a?n.createElement(h,r(r({ref:t},p),{},{components:a})):n.createElement(h,r({ref:t},p))}));function m(e,t){var a=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=a.length,r=new Array(o);r[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:i,r[1]=l;for(var u=2;u<o;u++)r[u]=a[u];return n.createElement.apply(null,r)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},2582:function(e,t,a){a.r(t),a.d(t,{frontMatter:function(){return l},contentTitle:function(){return s},metadata:function(){return u},toc:function(){return p},default:function(){return d}});var n=a(7462),i=a(3366),o=(a(7294),a(3905)),r=["components"],l={title:"Specify a custom location to aggregate pages that contain identifiers"},s=void 0,u={unversionedId:"custom-locations",id:"custom-locations",title:"Specify a custom location to aggregate pages that contain identifiers",description:"By default, Plausible tracks pages using their complete URLs as they are on your website. In some cases, you might want to provide Plausible with a custom URL to use instead of the actual URL of a page.",source:"@site/docs/custom-locations.md",sourceDirName:".",slug:"/custom-locations",permalink:"/docs/custom-locations",editUrl:"https://github.com/plausible/docs/edit/master/docs/custom-locations.md",tags:[],version:"current",frontMatter:{title:"Specify a custom location to aggregate pages that contain identifiers"}},p=[{value:"1. Add the <code>manual</code> script extension",id:"1-add-the-manual-script-extension",children:[],level:2},{value:"2. Trigger the pageview event",id:"2-trigger-the-pageview-event",children:[],level:2},{value:"3. Specify a custom location",id:"3-specify-a-custom-location",children:[],level:2},{value:"4. Visit your website to ensure it works",id:"4-visit-your-website-to-ensure-it-works",children:[],level:2},{value:"Common usage examples",id:"common-usage-examples",children:[{value:"Combining data for multiple pages based on canonical URL",id:"combining-data-for-multiple-pages-based-on-canonical-url",children:[],level:3},{value:"Redacting identifiers from URLs",id:"redacting-identifiers-from-urls",children:[],level:3}],level:2}],c={toc:p};function d(e){var t=e.components,a=(0,i.Z)(e,r);return(0,o.kt)("wrapper",(0,n.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"By default, Plausible tracks pages using their complete URLs as they are on your website. In some cases, you might want to provide Plausible with a custom URL to use instead of the actual URL of a page. "),(0,o.kt)("p",null,"This is especially helpful to redact and aggregate multiple pages whose URLs contain identifiers, personally identifiable information (PII) and other universally unique identifiers (UUID) specific to users. This is helpful both from the privacy and analytics perspective."),(0,o.kt)("p",null,"Follow the steps below to learn how you can specify a custom location for your pages and aggregate page URLs that contain identifiers:"),(0,o.kt)("h2",{id:"1-add-the-manual-script-extension"},"1. Add the ",(0,o.kt)("inlineCode",{parentName:"h2"},"manual")," script extension"),(0,o.kt)("p",null,"To specify a custom location for your event, you must use ",(0,o.kt)("a",{parentName:"p",href:"/docs/script-extensions#plausiblemanualjs"},"Plausible's manual script extension"),". "),(0,o.kt)("p",null,"To do so, change your Plausible script snippet ",(0,o.kt)("inlineCode",{parentName:"p"},"src")," attribute from ",(0,o.kt)("inlineCode",{parentName:"p"},"https://plausible.io/js/script.js")," to ",(0,o.kt)("inlineCode",{parentName:"p"},"https://plausible.io/js/script.manual.js"),"."),(0,o.kt)("p",null,"The new snippet will look like this (make sure to change the ",(0,o.kt)("inlineCode",{parentName:"p"},"data-domain")," attribute to the domain you added to your Plausible account):"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},'<script defer data-domain="yourdomain.com" src="https://plausible.io/js/script.manual.js"><\/script>\n')),(0,o.kt)("h2",{id:"2-trigger-the-pageview-event"},"2. Trigger the pageview event"),(0,o.kt)("p",null,"Once you've added the manual extension, the ",(0,o.kt)("inlineCode",{parentName:"p"},"pageview")," event won't be sent automatically anymore: you'll have to trigger it manually."),(0,o.kt)("p",null,"To trigger events manually, you need to add the following script after your regular Plausible tracking script:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},"\x3c!-- define the `plausible` function to manually trigger events --\x3e\n<script>window.plausible = window.plausible || function() { (window.plausible.q = window.plausible.q || []).push(arguments) }<\/script>\n")),(0,o.kt)("p",null,"Once that's done, you can create another script in which you will trigger your pageview event:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},"\x3c!-- trigger pageview --\x3e\n<script>\n  plausible('pageview');\n<\/script>\n")),(0,o.kt)("p",null,"At this point, your pageview events are being triggered just like before, but you haven't defined a custom location yet.\nThis is what we'll do in the next step."),(0,o.kt)("h2",{id:"3-specify-a-custom-location"},"3. Specify a custom location"),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"plausible")," function in the ",(0,o.kt)("inlineCode",{parentName:"p"},"manual")," script extension allows you to provide an option named ",(0,o.kt)("inlineCode",{parentName:"p"},"u"),".\nThis option allows you to specify the URL of the page you're on."),(0,o.kt)("p",null,"To make use of it, you can update your ",(0,o.kt)("inlineCode",{parentName:"p"},"pageview")," trigger code to add the ",(0,o.kt)("inlineCode",{parentName:"p"},"u")," option as the second parameter, like so:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"plausible('pageview', { u: \"https://yourdomain.com/my-custom-location\" });\n")),(0,o.kt)("p",null,"At this point, your entire setup should look like this:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},'<script defer data-domain="yourdomain.com" src="https://plausible.io/js/script.manual.js"><\/script>\n\x3c!-- define the `plausible` function to manually trigger events --\x3e\n<script>window.plausible = window.plausible || function() { (window.plausible.q = window.plausible.q || []).push(arguments) }<\/script>\n\x3c!-- trigger pageview --\x3e\n<script>\n  plausible(\'pageview\', { u: "https://yourdomain.com/my-custom-location" });\n<\/script>\n')),(0,o.kt)("p",null,"Once you have specified an URL via the ",(0,o.kt)("inlineCode",{parentName:"p"},"u")," option, all of the pageview events triggered from that script will be sent as if they came from that URL. In this case, all the pageview events will appear as if they came from ",(0,o.kt)("inlineCode",{parentName:"p"},"https://yourdomain.com/my-custom-location"),")."),(0,o.kt)("p",null,"You can specify the ",(0,o.kt)("inlineCode",{parentName:"p"},"u")," option in your other events as well if you wish to do so. "),(0,o.kt)("p",null,"In a real-world scenario, the URL you provide to Plausible would likely be dynamic, changing depending on the current page and context. The URL can be provided by a Javascript variable or function, or rendered by the server when generating the page. You can take a look at the examples below to see how URLs can be provided dynamically in common use cases."),(0,o.kt)("h2",{id:"4-visit-your-website-to-ensure-it-works"},"4. Visit your website to ensure it works"),(0,o.kt)("p",null,"You can test your custom location by visiting a page for which you specified a custom location, and ensuring pageviews events show up under the provided custom URL in your Plausible dashboard."),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"If you specify the same custom URL in all of your website's pages, all of your pages will be tracked as if they were the same. You should implement this feature with caution and test exhaustively to ensure that you are correctly tracking the data."))),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"common-usage-examples"},"Common usage examples"),(0,o.kt)("p",null,"Here are a few examples of scenarios in which specifying custom locations might be useful."),(0,o.kt)("h3",{id:"combining-data-for-multiple-pages-based-on-canonical-url"},"Combining data for multiple pages based on canonical URL"),(0,o.kt)("p",null,"Let's say you have multiple URLs that link to the same pages, such as:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"https://yourdomain.com/products/banana-leather-shoe")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"https://yourdomain.com/products/clothes/banana-leather-shoe")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"https://yourdomain.com/products/clothes/shoes/banana-leather-shoe")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"https://yourdomain.com/products/clothes/men/shoes/banana-leather-shoe"))),(0,o.kt)("p",null,"Perhaps you would like to combine all of the pageviews for these pages so they all appear in Plausible as the canonical URL for this product (which might be ",(0,o.kt)("inlineCode",{parentName:"p"},"https://yourdomain.com/products/banana-leather-shoe"),", for example)."),(0,o.kt)("p",null,"To do so, you could write a Javascript function that gets the canonical URL and that provides it to Plausible's pageview event:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},'<script defer data-domain="yourdomain.com" src="https://plausible.io/js/script.manual.js"><\/script>\n<script>window.plausible = window.plausible || function() { (window.plausible.q = window.plausible.q || []).push(arguments) }<\/script>\n<script>\n  // Get the canonical URL element\n  var canonicalMeta = document.querySelector(\'link[rel="canonical"]\');\n  // Use the canonical URL if it exists, falling back on the regular URL when it doesn\'t.\n  var url = canonicalMeta ? canonicalMeta.href : window.location.href;\n  // Send the pageview event to Plausible\n  plausible(\'pageview\', { u: url });\n<\/script>\n')),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Et voil\xe0!")," From now on, your pageviews will automatically appear as coming from the canonical URL (",(0,o.kt)("inlineCode",{parentName:"p"},"https://yourdomain.com/products/banana-leather-shoe")," for the product we used in our example)."),(0,o.kt)("p",null,"Plus, if you trigger other events on the page, you can reuse the ",(0,o.kt)("inlineCode",{parentName:"p"},"url")," variable we generated in order to keep your data consistent!"),(0,o.kt)("h3",{id:"redacting-identifiers-from-urls"},"Redacting identifiers from URLs"),(0,o.kt)("p",null,"If you have a web application, you likely have URLs with identifiers in them, such as ",(0,o.kt)("inlineCode",{parentName:"p"},"https://yourapp.com/project/123456/settings"),". This is great for your users as they can easily bookmark pages within your app. "),(0,o.kt)("p",null,"However, having the dashboard page of every project appear as individual pages in your analytics may not be all that great. In fact, it can rapidly make your data really hard to analyze: imagine seeing 100 different URLs in your analytics for the same route, instead of seeing a single URL with 100 pageviews."),(0,o.kt)("p",null,"In situations like these, redacting identifiers from URLs can make things much more manageable, and only takes a few minutes to implement."),(0,o.kt)("p",null,"For example, you could write a Javascript function that uses a regular expression to remove numerical identifiers from the URLs that Plausible receives:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},'<script defer data-domain="yourdomain.com" src="https://plausible.io/js/script.manual.js"><\/script>\n<script>window.plausible = window.plausible || function() { (window.plausible.q = window.plausible.q || []).push(arguments) }<\/script>\n<script>\n  var url = window.location.href;\n  // Replace every all-numeric sequences located between two slashes by "_ID_"\n  var redactedUrl = url.replace(/\\/\\d+\\//g, "/_ID_/");\n  // Send the pageview event to Plausible\n  plausible(\'pageview\', { u: redactedUrl });\n<\/script>\n')),(0,o.kt)("p",null,"And just like that, your pageviews will start being tracked as ",(0,o.kt)("inlineCode",{parentName:"p"},"https://yourapp.com/project/_ID_/settings"),". "),(0,o.kt)("p",null,"If your identifiers aren't entirely numerical, or if you only want to redact some identifiers but keep others, you can update the regular expression to match your format."),(0,o.kt)("p",null,"With all of the different identifiers being aggregated under the same URL, it's suddenly much easier to see which pages and features your visitors use the most!"),(0,o.kt)("p",null,"Thanks to ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/EmilePerron"},"\xc9mile Perron")," for the contribution!"))}d.isMDXComponent=!0}}]);