"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[527],{3905:function(e,t,o){o.d(t,{Zo:function(){return u},kt:function(){return p}});var n=o(7294);function a(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function r(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function i(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?r(Object(o),!0).forEach((function(t){a(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function s(e,t){if(null==e)return{};var o,n,a=function(e,t){if(null==e)return{};var o,n,a={},r=Object.keys(e);for(n=0;n<r.length;n++)o=r[n],t.indexOf(o)>=0||(a[o]=e[o]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)o=r[n],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}var c=n.createContext({}),d=function(e){var t=n.useContext(c),o=t;return e&&(o="function"==typeof e?e(t):i(i({},t),e)),o},u=function(e){var t=d(e.components);return n.createElement(c.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},l=n.forwardRef((function(e,t){var o=e.components,a=e.mdxType,r=e.originalType,c=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),l=d(o),p=a,h=l["".concat(c,".").concat(p)]||l[p]||m[p]||r;return o?n.createElement(h,i(i({ref:t},u),{},{components:o})):n.createElement(h,i({ref:t},u))}));function p(e,t){var o=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=o.length,i=new Array(r);i[0]=l;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:a,i[1]=s;for(var d=2;d<r;d++)i[d]=o[d];return n.createElement.apply(null,i)}return n.createElement.apply(null,o)}l.displayName="MDXCreateElement"},3833:function(e,t,o){o.r(t),o.d(t,{frontMatter:function(){return c},contentTitle:function(){return d},metadata:function(){return u},toc:function(){return m},default:function(){return p}});var n=o(7462),a=o(3366),r=(o(7294),o(3905)),i=o(4996),s=["components"],c={title:"Serve the script from your domain as a first-party connection"},d=void 0,u={unversionedId:"custom-domain",id:"custom-domain",title:"Serve the script from your domain as a first-party connection",description:"Custom domains are deprecated. They still work but we recommend those who use the custom domain to proxy the script instead. New to Plausible? Use the proxy instead of the custom domain. Here are the proxy instructions",source:"@site/docs/custom-domain.md",sourceDirName:".",slug:"/custom-domain",permalink:"/docs/custom-domain",editUrl:"https://github.com/plausible/docs/edit/master/docs/custom-domain.md",tags:[],version:"current",frontMatter:{title:"Serve the script from your domain as a first-party connection"}},m=[{value:"Type in your chosen subdomain",id:"type-in-your-chosen-subdomain",children:[],level:2},{value:"Create a new CNAME record for your chosen subdomain",id:"create-a-new-cname-record-for-your-chosen-subdomain",children:[],level:2},{value:"It may take up to 4 hours for the DNS changes to propagate",id:"it-may-take-up-to-4-hours-for-the-dns-changes-to-propagate",children:[],level:2},{value:"Replace the tracking code on your website with the new code",id:"replace-the-tracking-code-on-your-website-with-the-new-code",children:[],level:2},{value:"Should I create a custom domain for each of the sites that I want to track?",id:"should-i-create-a-custom-domain-for-each-of-the-sites-that-i-want-to-track",children:[],level:2},{value:"Remove the custom domain integration",id:"remove-the-custom-domain-integration",children:[],level:2}],l={toc:m};function p(e){var t=e.components,o=(0,a.Z)(e,s);return(0,r.kt)("wrapper",(0,n.Z)({},l,o,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Custom domains are deprecated. They still work but we recommend those who use the custom domain to proxy the script instead. New to Plausible? Use the proxy instead of the custom domain. ",(0,r.kt)("a",{parentName:"p",href:"/docs/proxy/introduction"},"Here are the proxy instructions")))),(0,r.kt)("p",null,'We offer a quick and easy way to serve the Plausible Analytics script from your domain name as a first-party connection. Click on the "',(0,r.kt)("strong",{parentName:"p"},"Add custom domain"),'" button in the "',(0,r.kt)("strong",{parentName:"p"},"Custom domain"),'" section of your website settings to get started.'),(0,r.kt)("img",{alt:"Serve the script from your domain as a first-party connection",src:(0,i.Z)("img/custom-domain.png")}),(0,r.kt)("h2",{id:"type-in-your-chosen-subdomain"},"Type in your chosen subdomain"),(0,r.kt)("p",null,"We recommend using a subdomain of the website you're running Plausible Analytics on. If your site is on ",(0,r.kt)("inlineCode",{parentName:"p"},"yourdomain.com")," you can use ",(0,r.kt)("inlineCode",{parentName:"p"},"plausible.yourdomain.com"),'. The name of the subdomain can be anything that you want. Type in your subdomain in the "',(0,r.kt)("strong",{parentName:"p"},"Domain"),'" field and click on the "',(0,r.kt)("strong",{parentName:"p"},"DNS setup"),'" button.'),(0,r.kt)("img",{alt:"Type in your chosen subdomain",src:(0,i.Z)("img/setup-custom-domain.png")}),(0,r.kt)("h2",{id:"create-a-new-cname-record-for-your-chosen-subdomain"},"Create a new CNAME record for your chosen subdomain"),(0,r.kt)("p",null,"Next, you need to go to your DNS provider\u2019s website and create a new CNAME record for your chosen subdomain. Please check with your DNS provider's documentation on how you can create a new CNAME record."),(0,r.kt)("p",null,"Point the CNAME record to ",(0,r.kt)("inlineCode",{parentName:"p"},"custom.plausible.io."),' (including the last dot) and then click on the "',(0,r.kt)("strong",{parentName:"p"},"Done"),'" button on the Plausible Analytics website.'),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Some domain registrars such as GoDaddy don't accept CNAME values with a dot at the end while others require it. If your registrar doesn't accept your CNAME records, please delete the dot at the end and try again."))),(0,r.kt)("img",{alt:"Create a new CNAME record for your chosen subdomain",src:(0,i.Z)("img/dns-cname-record.png")}),(0,r.kt)("h2",{id:"it-may-take-up-to-4-hours-for-the-dns-changes-to-propagate"},"It may take up to 4 hours for the DNS changes to propagate"),(0,r.kt)("p",null,"In most cases this process takes a few minutes but it may take up to 4 hours for the DNS changes to propagate and for us to obtain an SSL certificate for your subdomain."),(0,r.kt)("p",null,"You can check whether the CNAME record is set up correctly by entering your subdomain (",(0,r.kt)("inlineCode",{parentName:"p"},"yoursubdomain.yourdomain.com"),") in an ",(0,r.kt)("a",{parentName:"p",href:"https://www.nslookup.io/cname-lookup/"},"online CNAME lookup tool"),"."),(0,r.kt)("p",null,"The setup is completed and ready to use when your subdomain loads our JavaScript file (",(0,r.kt)("inlineCode",{parentName:"p"},"yoursubdomain.yourdomain.com/js/index.js"),"). Keep using the default snippet on your site until your subdomain loads the JavaScript file."),(0,r.kt)("p",null,"Don't worry if your subdomain (",(0,r.kt)("inlineCode",{parentName:"p"},"yoursubdomain.yourdomain.com"),") shows a 404 error. That's expected behaviour. The important part is that the script itself loads from your subdomain (",(0,r.kt)("inlineCode",{parentName:"p"},"yoursubdomain.yourdomain.com/js/index.js"),"). That's when you can replace the snippet on your site."),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Do you have a wildcard SSL configuration, so your subdomains automatically get the SSL certificate? Please disable it for the subdomain you want to serve Plausible script from. We will automatically get the SSL certificate from Let's Encrypt for your subdomain."))),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Using Cloudflare for DNS and having your sites proxied behind Cloudflare? A proxy in front of your custom domain can override the remote IP which would lead to wrong geolocation data in your stats. Are you seeing some SSL or other errors? Cloudflare proxy may be the culprit because it doesn't allow our server to provision an SSL certificate to you. In both of these cases, removing the proxy and making it just a DNS record in your Cloudflare settings solves the issue."))),(0,r.kt)("h2",{id:"replace-the-tracking-code-on-your-website-with-the-new-code"},"Replace the tracking code on your website with the new code"),(0,r.kt)("p",null,"When our JavaScript file loads from your subdomain, you can finish your setup by replacing the tracking code on your site with something that looks like the following code (your custom code will be shown on the confirmation page):"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-html"},'<script defer data-domain="yourdomain.com" src="https://yoursubdomain.yourdomain.com/js/index.js"><\/script>\n')),(0,r.kt)("img",{alt:"Update the tracking code on your site",src:(0,i.Z)("img/update-javascript-snippet.png")}),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Using CSP? Do not forget to add this new subdomain specifically to your Content Security Policy too."))),(0,r.kt)("h2",{id:"should-i-create-a-custom-domain-for-each-of-the-sites-that-i-want-to-track"},"Should I create a custom domain for each of the sites that I want to track?"),(0,r.kt)("p",null,"This is not necessary. You could use one custom domain for all your sites."),(0,r.kt)("p",null,"This is convenient if you're running several sites as subdomains. In that case you could create plausible.yourdomain.com as your custom domain and use that for all the different subdomains you have as part of yourdomain.com (subdomain1.yourdomain.com, subdomain2.yourdomain.com etc)."),(0,r.kt)("p",null,"You can use the same custom domain on your other domains too. The only difference is that in those cases you'll be making a call to plausible.yourdomain.com from yourotherdomain.com rather than having it all under the same domain. The functionality remains the same and everything still works fine."),(0,r.kt)("h2",{id:"remove-the-custom-domain-integration"},"Remove the custom domain integration"),(0,r.kt)("p",null,"If you'd like to remove the custom domain you have configured, click on the \"",(0,r.kt)("strong",{parentName:"p"},"Remove custom domain"),'" button in the "',(0,r.kt)("strong",{parentName:"p"},"Custom domain"),'" section of your website settings.'))}p.isMDXComponent=!0}}]);